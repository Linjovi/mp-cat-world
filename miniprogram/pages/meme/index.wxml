<view class="container" style="padding-top: {{statusBarHeight + navBarHeight}}px">
  <!-- Custom Navigation Bar -->
  <view class="custom-nav" style="padding-top: {{statusBarHeight}}px; height: {{navBarHeight}}px">
    <view class="nav-title" style="line-height: {{navBarHeight}}px">âœ¨ è¡¨æƒ…åŒ…åˆ¶ä½œå–µ âœ¨</view>
  </view>

  <!-- Tabs with new container for scroll/layout -->
  <view class="tabs-container">
    <view class="tabs">
        <view 
        wx:for="{{tabs}}" 
        wx:key="id" 
        class="tab-item {{activeTab === item.id ? 'active' : ''}}"
        bindtap="switchTab"
        data-id="{{item.id}}"
        >
        {{item.name}}
        <view class="active-dot" wx:if="{{activeTab === item.id}}"></view>
        </view>
    </view>
  </view>

  <!-- Content -->
  <view class="content-area">
    
    <!-- Type 1: Nine Grid -->
    <nine-grid 
      wx:if="{{activeTab === 1}}" 
      image="{{image}}" 
      style="{{style}}" 
      description="{{description}}" 
      generatedImage="{{generatedImage}}"
      bind:updateImage="onUpdateImage" 
      bind:updateStyle="onUpdateStyle" 
      bind:updateDescription="onUpdateDesc" 
      bind:reset="onReset"
    />

    <!-- Type 2: Reference/Mimicry -->
    <mimicry 
      wx:if="{{activeTab === 2}}" 
      image="{{image}}" 
      refImage="{{refImage}}" 
      generatedImage="{{generatedImage}}"
      bind:updateImage="onUpdateImage" 
      bind:reset="onReset"
    />

    <!-- Type 3: GIF -->
    <gif-maker 
      id="gifMaker"
      wx:if="{{activeTab === 3}}" 
      image="{{image}}" 
      gifPrompt="{{gifPrompt}}" 
      generatedImage="{{generatedImage}}"
      fps="{{fps}}"
      bind:updateImage="onUpdateImage" 
      bind:updateGifPrompt="onUpdateGifPrompt" 
      bind:fpsChange="onFpsChange"
      bind:reset="onReset"
      bind:updateGeneratedImage="onUpdateGeneratedImage"
    />

    <!-- Error Msg -->
    <view wx:if="{{error}}" class="error-msg shake">ğŸ˜¿ {{error}}</view>

    <!-- Progress -->
    <view wx:if="{{loading}}" class="progress-wrap fade-in">
        <view class="loading-cat">
            <view class="cat-head">ğŸ±</view>
        </view>
       <view class="progress-info">
         <text>æ–½å±•é­”æ³•ä¸­...</text>
         <text>{{progress}}%</text>
       </view>
       <view class="progress-bar-bg">
         <view class="progress-bar-fill" style="width: {{progress}}%"></view>
       </view>
    </view>

    <!-- Generate Button -->
    <button 
      class="generate-btn {{loading ? 'loading' : ''}} {{activeTab===3 ? 'purple-btn' : ''}}" 
      bindtap="handleGenerate"
      disabled="{{loading}}"
    >
       <text class="btn-text">{{loading ? 'âœ¨ åˆ¶ä½œä¸­...' : activeTab === 3 ? 'âœ¨ ç”ŸæˆåŠ¨å›¾' : 'âœ¨ ç«‹å³ç”Ÿæˆ'}}</text>
    </button>
  </view>
</view>
