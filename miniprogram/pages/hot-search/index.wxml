<view class="container">
  <!-- Header Background -->
  <view class="header-bg"></view>

  <!-- Header Content -->
  <view class="header">
    <view class="title-bar">
      <text class="title">吃瓜喵</text>
      <text class="subtitle">全网热瓜 · 一网打尽</text>
    </view>

    <!-- Tabs -->
    <view class="tabs-container">
      <view class="tabs">
        <view 
          wx:for="{{sources}}" 
          wx:key="key"
          class="tab-item {{currentSource === item.key ? 'active' : ''}}"
          bindtap="switchTab"
          data-source="{{item.key}}"
        >
          <text class="tab-icon">{{item.icon}}</text>
          <text class="tab-name {{currentSource === item.key ? item.color : ''}}">{{item.name}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- Content Swiper -->
  <swiper 
    class="content-swiper" 
    current="{{swiperIndex}}" 
    bindchange="onSwiperChange"
    duration="300"
  >
    <block wx:for="{{sources}}" wx:key="key" wx:for-item="sourceItem">
      <swiper-item>
        <scroll-view 
          scroll-y 
          class="data-list"
          refresher-enabled="{{false}}"
        >
          <!-- Loading State -->
          <view wx:if="{{loading[sourceItem.key]}}" class="loading-state">
            <view class="loading-spinner {{sourceItem.key}}"></view>
            <text>正在搬运大瓜...</text>
          </view>

          <!-- Error State -->
          <view wx:elif="{{error[sourceItem.key]}}" class="error-state">
            <text catchtap="fetchSourceData" data-source="{{sourceItem.key}}">加载失败，点击重试</text>
          </view>

          <!-- Data List -->
          <view wx:else class="list-content">
            <block wx:if="{{sourceItem.key === 'douyin'}}">
              <view 
                wx:for="{{douyinData.list}}" 
                wx:key="title" 
                class="list-item"
              >
                 <include src="./item-template.wxml" />
              </view>
            </block>
             <block wx:elif="{{sourceItem.key === 'xiaohongshu'}}">
              <view 
                wx:for="{{xhsData.list}}" 
                wx:key="title" 
                class="list-item"
              >
                <include src="./item-template.wxml" />
              </view>
            </block>
             <block wx:elif="{{sourceItem.key === 'weibo'}}">
              <view 
                wx:for="{{weiboData.list}}" 
                wx:key="title" 
                class="list-item"
              >
                <include src="./item-template.wxml" />
              </view>
            </block>
             <block wx:elif="{{sourceItem.key === 'maoyan'}}">
              <view 
                wx:for="{{maoyanData.list}}" 
                wx:key="title" 
                class="list-item"
              >
                <include src="./item-template.wxml" />
              </view>
            </block>
          </view>
          
          <view style="height: 100rpx;"></view> <!-- Bottom padding -->
        </scroll-view>
      </swiper-item>
    </block>
  </swiper>
</view>
