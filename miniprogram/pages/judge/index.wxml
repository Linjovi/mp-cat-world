<view class="container">
  <!-- Header Card -->
  <view class="header-card">
    <view class="avatar-wrapper">
      <image class="judge-avatar" src="https://images.unsplash.com/photo-1592194996308-7b43878e84a6?q=80&w=1000&auto=format&fit=crop" mode="aspectFill"></image>
      <view class="avatar-label">å…¬æ­£ã®å–µæ³•å®˜</view>
    </view>
    <view class="header-text">
      <view class="app-title">çŒ«çŒ«å·¡å›æ³•åº­</view>
      <view class="app-slogan">"æœ¬å–µå®£åˆ¤ï¼šè™½ç„¶æˆ‘å¯çˆ±ï¼Œä½†æˆ‘è¶…å…¬æ­£ï¼å–µ~"</view>
    </view>
  </view>

  <!-- INPUT STEP -->
  <block wx:if="{{step === 'input'}}">
    <view class="form-area animate-fade-in">
      <view class="form-group">
        <view class="label">
          <text class="icon">ğŸ“œ</text> æ¡ˆå‘ç»è¿‡ (å¿…å¡«)
        </view>
        <textarea 
          class="input-area" 
          placeholder="è¯·è¯¦ç»†æè¿°çŸ›ç›¾çš„èµ·å› ..." 
          bindinput="onInput" 
          data-field="cause"
          value="{{formData.cause}}"
          maxlength="500"
        ></textarea>
      </view>

      <view class="players-grid">
        <!-- Player A -->
        <view class="player-card blue">
          <view class="player-header">
            <text class="player-label">å½“äº‹äºº A</text>
            <input 
              class="player-name-input"
              placeholder="æ˜µç§° (å¦‚: æ²¡å¤´è„‘)" 
              value="{{formData.nameA}}" 
              bindinput="onInput" 
              data-field="nameA" 
            />
          </view>
          <textarea 
            class="player-reason" 
            placeholder="A çš„ç†ç”±..." 
            value="{{formData.sideA}}" 
            bindinput="onInput" 
            data-field="sideA"
            maxlength="200"
          ></textarea>
        </view>

        <!-- Player B -->
        <view class="player-card red">
          <view class="player-header">
            <text class="player-label">å½“äº‹äºº B</text>
            <input 
              class="player-name-input"
              placeholder="æ˜µç§° (å¦‚: ä¸é«˜å…´)" 
              value="{{formData.nameB}}" 
              bindinput="onInput" 
              data-field="nameB" 
            />
          </view>
          <textarea 
            class="player-reason" 
            placeholder="B çš„ç†ç”±..." 
            value="{{formData.sideB}}" 
            bindinput="onInput" 
            data-field="sideB"
            maxlength="200"
          ></textarea>
        </view>
      </view>

      <button class="submit-btn" bindtap="submitForm" hover-class="btn-hover">
        <text>ğŸ¾ å‡å ‚ï¼è¯·æ±‚è£å†³ï¼ ğŸ¾</text>
      </button>
    </view>
  </block>

  <!-- THINKING STEP -->
  <block wx:elif="{{step === 'thinking'}}">
    <view class="loading-area animate-fade-in">
      <view class="cat-loader">
        <view class="cat-head">
           <view class="cat-ear left"></view>
           <view class="cat-ear right"></view>
        </view>
      </view>
      <text class="loading-text">çŒ«çŒ«æ³•å®˜æ­£åœ¨æ¢³ç†æ¯›å‘(æ€è€ƒæ¡ˆæƒ…)...</text>
    </view>
  </block>

  <!-- RESULT STEP -->
  <block wx:elif="{{step === 'result'}}">
    <view class="result-container animate-slide-up">
      <view class="result-card">
        <view class="winner-banner {{result.winner === 'A' ? 'blue' : result.winner === 'B' ? 'red' : 'gray'}}">
          <text wx:if="{{result.winner === 'A'}}">ğŸ† {{formData.nameA || 'A'}} èƒœè¯‰ï¼</text>
          <text wx:elif="{{result.winner === 'B'}}">ğŸ† {{formData.nameB || 'B'}} èƒœè¯‰ï¼</text>
          <text wx:else>âš–ï¸ å¹³å±€ï¼å„æ‰“äº”åå¤§æ¿ï¼</text>
        </view>

        <view class="scores-section" wx:if="{{result.scoreA !== undefined && result.scoreB !== undefined}}">
            <view class="score-row">
                <view class="score-item blue">
                    <text class="score-label">{{formData.nameA || 'A'}}</text>
                    <text class="score-value">{{result.scoreA}}</text>
                </view>
                 <view class="score-vs">VS</view>
                <view class="score-item red">
                    <text class="score-label">{{formData.nameB || 'B'}}</text>
                    <text class="score-value">{{result.scoreB}}</text>
                </view>
            </view>
        </view>

        <view class="verdict-section">
          <view class="section-title">âš–ï¸ æ³•å®˜è£å†³</view>
          <view class="verdict-title" wx:if="{{result.verdictTitle}}">{{result.verdictTitle}}</view>
          <text class="verdict-text">{{result.analysis || result.verdict}}</text>
        </view>

        <view class="action-section" wx:if="{{result.actionItems && result.actionItems.length > 0}}">
             <view class="section-title">ğŸ“ æ‰§è¡Œæ¸…å•</view>
             <view class="action-list">
               <view class="action-item" wx:for="{{result.actionItems}}" wx:key="*this">
                 <text>{{item}}</text>
               </view>
             </view>
        </view>

        <view class="comment-section">
          <view class="section-title">ğŸ˜¼ çŒ«çŒ«é”è¯„</view>
          <text class="comment-text">{{result.funnyComment || result.comment}}</text>
        </view>

        <!-- Stamp -->
        <view class="stamp {{result.winner === 'A' ? 'stamp-blue' : result.winner === 'B' ? 'stamp-red' : 'stamp-gray'}}">
           <text wx:if="{{result.winner === 'A'}}">Aèƒœè¯‰</text>
           <text wx:elif="{{result.winner === 'B'}}">Bèƒœè¯‰</text>
           <text wx:else>å¹³å±€</text>
        </view>
      </view>

      <button class="reset-btn" bindtap="resetForm" hover-class="btn-hover">
        é€€å ‚ (å†åˆ¤ä¸€ä¸ª)
      </button>
    </view>
  </block>
</view>
